--[[  
    femtanyl UI Library  
    ---------------------------------------------------------
    • Clean, simple, expandable
    • Tabs, Sections, Buttons, Toggles, Sliders, Keybinds
    • Notifications
    • Proper frame rescaling (all children scale correctly)
    • Dragging + resizing
    • Matches your original layout, fonts, colors and sizes

    Made by ChatGPT
--]]

local UILibrary = {}
local UserInputService = game:GetService("UserInputService")
local TweenService = game:GetService("TweenService")

----------------------------------------------------------
-- UTIL FUNCTIONS
----------------------------------------------------------
local function MakeDragging(frame)
    local dragging, dragStart, startPos

    frame.InputBegan:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseButton1 then
            dragging = true
            dragStart = input.Position
            startPos = frame.Position
        end
    end)

    frame.InputEnded:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseButton1 then
            dragging = false
        end
    end)

    UserInputService.InputChanged:Connect(function(input)
        if dragging and input.UserInputType == Enum.UserInputType.MouseMovement then
            local delta = input.Position - dragStart
            frame.Position = UDim2.new(
                startPos.X.Scale,
                startPos.X.Offset + delta.X,
                startPos.Y.Scale,
                startPos.Y.Offset + delta.Y
            )
        end
    end)
end

local function MakeResizer(frame, corner)
    local resizing = false
    local startPos, startSize, startInput

    corner.InputBegan:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseButton1 then
            resizing = true
            startPos = frame.AbsolutePosition
            startSize = frame.AbsoluteSize
            startInput = input.Position
        end
    end)

    UserInputService.InputEnded:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseButton1 then
            resizing = false
        end
    end)

    UserInputService.InputChanged:Connect(function(input)
        if resizing and input.UserInputType == Enum.UserInputType.MouseMovement then
            
            local delta = input.Position - startInput
            local newX = math.max(300, startSize.X + delta.X)
            local newY = math.max(200, startSize.Y + delta.Y)

            frame.Size = UDim2.new(0, newX, 0, newY)
        end
    end)
end

----------------------------------------------------------
-- MAIN WINDOW
----------------------------------------------------------
function UILibrary:CreateWindow(cfg)
    cfg = cfg or {}
    local TitleText = cfg.Name or "femtanyl"

    ------------------------------------------------------
    -- ScreenGui
    ------------------------------------------------------
    local gui = Instance.new("ScreenGui")
    gui.Parent = game.CoreGui
    gui.ZIndexBehavior = Enum.ZIndexBehavior.Sibling

    ------------------------------------------------------
    -- Main Frame
    ------------------------------------------------------
    local Frame = Instance.new("Frame")
    Frame.Size = UDim2.new(0, 504, 0, 348)
    Frame.Position = UDim2.new(0.355, 0, 0.18, 0)
    Frame.BackgroundColor3 = Color3.fromRGB(24,24,24)
    Frame.BorderSizePixel = 0
    Frame.Parent = gui

    MakeDragging(Frame)

    ------------------------------------------------------
    -- Header
    ------------------------------------------------------
    local header = Instance.new("Frame")
    header.Size = UDim2.new(1,0,0,30)
    header.BackgroundColor3 = Color3.fromRGB(14,14,14)
    header.BorderSizePixel = 0
    header.Parent = Frame

    -- Logo
    local Logo = Instance.new("ImageLabel")
    Logo.Size = UDim2.new(0,64,0,64)
    Logo.Position = UDim2.new(0, -5, 0, -17)
    Logo.BackgroundTransparency = 1
    Logo.Image = "rbxassetid://90362415610289"
    Logo.Parent = header

    -- Title left-aligned
    local Title = Instance.new("TextLabel")
    Title.BackgroundTransparency = 1
    Title.Position = UDim2.new(0.21,0,0,0)
    Title.Size = UDim2.new(0,200,0,30)
    Title.Text = TitleText
    Title.TextColor3 = Color3.new(1,1,1)
    Title.FontFace = Font.new("rbxasset://fonts/families/RobotoMono.json", Enum.FontWeight.SemiBold)
    Title.TextXAlignment = Enum.TextXAlignment.Left
    Title.TextSize = 14
    Title.BorderSizePixel = 0
    Title.Parent = header

    -- Version + Clock (right aligned)
    local VersionClock = Instance.new("TextLabel")
    VersionClock.BackgroundTransparency = 1
    VersionClock.Position = UDim2.new(0.21,0,0,0)
    VersionClock.Size = UDim2.new(0,392,0,30)
    VersionClock.Text = "v1.0.0 | " .. os.date("%H:%M:%S")
    VersionClock.TextXAlignment = Enum.TextXAlignment.Right
    VersionClock.TextColor3 = Color3.new(1,1,1)
    VersionClock.FontFace = Font.new("rbxasset://fonts/families/RobotoMono.json", Enum.FontWeight.SemiBold)
    VersionClock.TextSize = 14
    VersionClock.Parent = header

    ------------------------------------------------------
    -- Tabs
    ------------------------------------------------------
    local Tabs = Instance.new("Frame")
    Tabs.Size = UDim2.new(0,100,0,Frame.AbsoluteSize.Y - 30)
    Tabs.Position = UDim2.new(0,0,0,30)
    Tabs.BackgroundColor3 = Color3.fromRGB(14,14,14)
    Tabs.BorderSizePixel = 0
    Tabs.Parent = Frame

    local TabList = Instance.new("UIListLayout")
    TabList.Parent = Tabs
    TabList.SortOrder = Enum.SortOrder.LayoutOrder

    ------------------------------------------------------
    -- Tab Page Container
    ------------------------------------------------------
    local PageHolder = Instance.new("Frame")
    PageHolder.Size = UDim2.new(1, -100, 1, -30)
    PageHolder.Position = UDim2.new(0, 100, 0, 30)
    PageHolder.BackgroundTransparency = 1
    PageHolder.BorderSizePixel = 0
    PageHolder.Parent = Frame

    ------------------------------------------------------
    -- Resize Handle (smaller + transparent)
    ------------------------------------------------------
    local Corner = Instance.new("ImageButton")
    Corner.Size = UDim2.new(0,14,0,14)
    Corner.Position = UDim2.new(1,-14,1,-14)
    Corner.BackgroundTransparency = 1
    Corner.ImageTransparency = 0.4
    Corner.Image = "rbxassetid://10723346553"
    Corner.Parent = Frame

    MakeResizer(Frame, Corner)

    ------------------------------------------------------
    -- API RETURN
    ------------------------------------------------------
    local window = {}

    ------------------------------------------------------
    -- Create Tab
    ------------------------------------------------------
    function window:CreateTab(name)
        local tabButton = Instance.new("TextButton")
        tabButton.Size = UDim2.new(1,0,0,30)
        tabButton.BackgroundTransparency = 1
        tabButton.Text = name
        tabButton.TextColor3 = Color3.new(1,1,1)
        tabButton.FontFace = Font.new("rbxasset://fonts/families/RobotoMono.json")
        tabButton.TextSize = 14
        tabButton.Parent = Tabs

        --------------------------------------------------
        -- Tab Page
        --------------------------------------------------
        local page = Instance.new("ScrollingFrame")
        page.Size = UDim2.new(1,0,1,0)
        page.AutomaticCanvasSize = Enum.AutomaticSize.Y
        page.CanvasSize = UDim2.new(0,0,0,0)
        page.BackgroundTransparency = 1
        page.BorderSizePixel = 0
        page.Visible = false
        page.Parent = PageHolder

        local Layout = Instance.new("UIListLayout")
        Layout.Padding = UDim.new(0,6)
        Layout.Parent = page

        tabButton.MouseButton1Click:Connect(function()
            for _,v in ipairs(PageHolder:GetChildren()) do
                if v:IsA("ScrollingFrame") then v.Visible = false end
            end
            page.Visible = true
        end)

        --------------------------------------------------
        -- Section API
        --------------------------------------------------
        local tabAPI = {}

        function tabAPI:CreateSection(title)
            local section = Instance.new("Frame")
            section.Size = UDim2.new(1,-14,0,30)
            section.BackgroundColor3 = Color3.fromRGB(24,24,24)
            section.BorderSizePixel = 0
            section.Parent = page

            local label = Instance.new("TextLabel")
            label.BackgroundTransparency = 1
            label.Size = UDim2.new(1, -10, 1, 0)
            label.Position = UDim2.new(0,5,0,0)
            label.Text = title
            label.TextColor3 = Color3.new(1,1,1)
            label.FontFace = Font.new("rbxasset://fonts/families/RobotoMono.json", Enum.FontWeight.Bold)
            label.TextSize = 14
            label.Parent = section

            local sectionAPI = {}

            --------------------------------------------------
            -- BUTTON
            --------------------------------------------------
            function sectionAPI:Button(text, callback)
                callback = callback or function() end

                local btn = Instance.new("TextButton")
                btn.Size = UDim2.new(1, -14, 0, 26)
                btn.BackgroundColor3 = Color3.fromRGB(14,14,14)
                btn.TextColor3 = Color3.new(1,1,1)
                btn.FontFace = Font.new("rbxasset://fonts/families/RobotoMono.json")
                btn.TextSize = 14
                btn.Text = text
                btn.BorderSizePixel = 0
                btn.Parent = page

                btn.MouseButton1Click:Connect(function()
                    callback()
                end)
            end

            --------------------------------------------------
            -- TOGGLE
            --------------------------------------------------
            function sectionAPI:Toggle(text, default, callback)
                callback = callback or function() end
                local state = default or false

                local back = Instance.new("Frame")
                back.Size = UDim2.new(1, -14, 0, 26)
                back.BackgroundColor3 = Color3.fromRGB(14,14,14)
                back.BorderSizePixel = 0
                back.Parent = page

                local label = Instance.new("TextLabel")
                label.Size = UDim2.new(1,-40,1,0)
                label.Position = UDim2.new(0,10,0,0)
                label.BackgroundTransparency = 1
                label.Text = text
                label.TextColor3 = Color3.new(1,1,1)
                label.FontFace = Font.new("rbxasset://fonts/families/RobotoMono.json")
                label.TextSize = 14
                label.Parent = back

                local toggleBtn = Instance.new("TextButton")
                toggleBtn.Size = UDim2.new(0,30,0,20)
                toggleBtn.Position = UDim2.new(1,-35,0.5,-10)
                toggleBtn.BackgroundColor3 = state and Color3.fromRGB(0,170,0) or Color3.fromRGB(90,90,90)
                toggleBtn.Text = ""
                toggleBtn.BorderSizePixel = 0
                toggleBtn.Parent = back

                toggleBtn.MouseButton1Click:Connect(function()
                    state = not state
                    toggleBtn.BackgroundColor3 = state and Color3.fromRGB(0,170,0) or Color3.fromRGB(90,90,90)
                    callback(state)
                end)
            end

            --------------------------------------------------
            -- SLIDER
            --------------------------------------------------
            function sectionAPI:Slider(text, min, max, default, callback)
                callback = callback or function() end

                local val = default or min

                local frame = Instance.new("Frame")
                frame.Size = UDim2.new(1,-14,0,40)
                frame.BackgroundColor3 = Color3.fromRGB(14,14,14)
                frame.BorderSizePixel = 0
                frame.Parent = page

                local label = Instance.new("TextLabel")
                label.Size = UDim2.new(1,0,0,20)
                label.BackgroundTransparency = 1
                label.Text = text .. ": " .. val
                label.TextColor3 = Color3.new(1,1,1)
                label.FontFace = Font.new("rbxasset://fonts/families/RobotoMono.json")
                label.TextSize = 14
                label.Parent = frame

                local barBack = Instance.new("Frame")
                barBack.Size = UDim2.new(1,-20,0,8)
                barBack.Position = UDim2.new(0,10,0,26)
                barBack.BackgroundColor3 = Color3.fromRGB(50,50,50)
                barBack.BorderSizePixel = 0
                barBack.Parent = frame

                local bar = Instance.new("Frame")
                bar.Size = UDim2.new((val-min)/(max-min),0,1,0)
                bar.BackgroundColor3 = Color3.fromRGB(0,170,0)
                bar.BorderSizePixel = 0
                bar.Parent = barBack

                local dragging = false
                barBack.InputBegan:Connect(function(input)
                    if input.UserInputType == Enum.UserInputType.MouseButton1 then
                        dragging = true
                    end
                end)
                UserInputService.InputEnded:Connect(function(input)
                    if input.UserInputType == Enum.UserInputType.MouseButton1 then
                        dragging = false
                    end
                end)

                UserInputService.InputChanged:Connect(function(input)
                    if dragging and input.UserInputType == Enum.UserInputType.MouseMovement then
                        local rel = math.clamp((input.Position.X - barBack.AbsolutePosition.X) / barBack.AbsoluteSize.X, 0, 1)
                        bar.Size = UDim2.new(rel,0,1,0)
                        val = math.floor(min + (max-min)*rel)
                        label.Text = text .. ": " .. val
                        callback(val)
                    end
                end)
            end

            --------------------------------------------------
            -- KEYBIND
            --------------------------------------------------
            function sectionAPI:Keybind(text, defaultKey, callback)
                callback = callback or function() end
                local Key = defaultKey or Enum.KeyCode.F
                local keyWait = false

                local frame = Instance.new("Frame")
                frame.Size = UDim2.new(1,-14,0,26)
                frame.BackgroundColor3 = Color3.fromRGB(14,14,14)
                frame.BorderSizePixel = 0
                frame.Parent = page

                local label = Instance.new("TextLabel")
                label.Size = UDim2.new(1,-50,1,0)
                label.Position = UDim2.new(0,10,0,0)
                label.BackgroundTransparency = 1
                label.Text = text .. " [".. Key.Name .."]"
                label.TextColor3 = Color3.new(1,1,1)
                label.FontFace = Font.new("rbxasset://fonts/families/RobotoMono.json")
                label.TextSize = 14
                label.Parent = frame

                local button = Instance.new("TextButton")
                button.Size = UDim2.new(0,40,0,20)
                button.Position = UDim2.new(1,-45,0.5,-10)
                button.BackgroundColor3 = Color3.fromRGB(50,50,50)
                button.Text = "Set"
                button.TextColor3 = Color3.new(1,1,1)
                button.BorderSizePixel = 0
                button.Font = Enum.Font.Code
                button.TextSize = 12
                button.Parent = frame

                button.MouseButton1Click:Connect(function()
                    label.Text = text .. " [Press Key]"
                    keyWait = true
                end)

                UserInputService.InputBegan:Connect(function(input)
                    if keyWait then
                        if input.KeyCode ~= Enum.KeyCode.Unknown then
                            Key = input.KeyCode
                            label.Text = text .. " ["..Key.Name.."]"
                            keyWait = false
                        end
                    else
                        if input.KeyCode == Key then
                            callback()
                        end
                    end
                end)
            end

            return sectionAPI
        end

        return tabAPI
    end

    ------------------------------------------------------
    -- Notifications
    ------------------------------------------------------
    function window:Notify(text)
        local notif = Instance.new("Frame")
        notif.Size = UDim2.new(0,200,0,28)
        notif.Position = UDim2.new(1,-210,1,-40)
        notif.BackgroundColor3 = Color3.fromRGB(24,24,24)
        notif.BorderSizePixel = 0
        notif.Parent = gui

        local lbl = Instance.new("TextLabel")
        lbl.BackgroundTransparency = 1
        lbl.Size = UDim2.new(1,-10,1,0)
        lbl.Position = UDim2.new(0,5,0,0)
        lbl.Text = text
        lbl.FontFace = Font.new("rbxasset://fonts/families/RobotoMono.json")
        lbl.TextColor3 = Color3.new(1,1,1)
        lbl.TextSize = 14
        lbl.TextXAlignment = Enum.TextXAlignment.Left
        lbl.Parent = notif

        -- slide in
        TweenService:Create(notif, TweenInfo.new(0.3), {
            Position = UDim2.new(1,-210,1,-70)
        }):Play()

        task.delay(2, function()
            TweenService:Create(notif, TweenInfo.new(0.3), {
                Position = UDim2.new(1,20,1,-70)
            }):Play()
            task.wait(0.3)
            notif:Destroy()
        end)
    end

    return window
end


return UILibrary
